<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulador PPR 2025 | Público 3</title>

  <style>
    :root{
      --kof-red:#d5001c;
      --kof-black:#111;
      --kof-gray:#2a2a2a;
      --kof-soft:#f4f4f4;
      --card:#ffffff14;
      --stroke:#ffffff2b;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:#fff;
      background:
        radial-gradient(1200px 600px at 70% 30%, #ffffff10 0%, transparent 55%),
        radial-gradient(900px 500px at 15% 20%, #d5001c25 0%, transparent 55%),
        linear-gradient(135deg, #0b0b0b 0%, #151515 40%, #0f0f0f 100%);
      min-height:100vh;
    }

    /* Header */
    header{
      position:sticky; top:0; z-index:10;
      background:#0b0b0be6;
      backdrop-filter: blur(8px);
      border-bottom:1px solid #ffffff14;
    }
    .topbar{
      max-width:1200px; margin:0 auto;
      padding:12px 16px;
      display:flex; align-items:center; justify-content:space-between; gap:14px;
    }
    .brand{
      display:flex; align-items:center; gap:10px;
      font-weight:700; letter-spacing:.2px;
    }
    .logo{
      width:38px; height:38px; border-radius:10px;
      background:linear-gradient(135deg, var(--kof-red), #8b0011);
      display:grid; place-items:center;
      box-shadow:0 10px 30px #00000055;
      border:1px solid #ffffff1f;
      font-size:12px;
    }
    nav a{
      color:#fff; text-decoration:none; opacity:.9;
      padding:8px 10px; border-radius:10px;
    }
    nav a:hover{ background:#ffffff10; opacity:1; }
    .tag{
      font-size:12px; opacity:.85;
      border:1px solid #ffffff20;
      padding:6px 10px; border-radius:999px;
      background:#ffffff10;
      white-space:nowrap;
    }

    /* Layout */
    .wrap{ max-width:1200px; margin:0 auto; padding:22px 16px 40px; }
    h1{
      margin:16px 0 8px;
      font-size:28px; letter-spacing:.2px;
    }
    .subtitle{ opacity:.85; margin:0 0 18px; }

    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:16px;
      align-items:start;
    }
    @media (max-width: 980px){
      .grid{ grid-template-columns:1fr; }
    }

    .panel{
      background:var(--card);
      border:1px solid var(--stroke);
      border-radius:18px;
      padding:16px;
      box-shadow: 0 18px 60px #00000055;
    }

    /* Inputs row */
    .row{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap:10px;
    }
    @media (max-width: 980px){
      .row{ grid-template-columns:1fr 1fr; }
    }
    @media (max-width: 520px){
      .row{ grid-template-columns:1fr; }
    }
    .field label{
      display:block;
      font-size:12px;
      opacity:.9;
      margin:0 0 6px;
    }
    .field input{
      width:100%;
      border-radius:12px;
      border:1px solid #ffffff25;
      background:#0e0e0ecc;
      color:#fff;
      padding:12px 12px;
      outline:none;
      font-size:14px;
    }
    .field input:focus{
      border-color:#ffffff40;
      box-shadow:0 0 0 4px #d5001c20;
    }

    .actions{
      margin-top:12px;
      display:flex; gap:10px; flex-wrap:wrap; align-items:center;
    }
    button{
      border:none;
      border-radius:12px;
      padding:12px 16px;
      font-weight:700;
      cursor:pointer;
    }
    .btn-primary{
      background:var(--kof-red);
      color:#fff;
      box-shadow: 0 14px 28px #d5001c35;
    }
    .btn-secondary{
      background:#ffffff10;
      color:#fff;
      border:1px solid #ffffff20;
    }
    .hint{
      font-size:12px;
      opacity:.85;
    }

    /* Formula blocks */
    .formula{
      margin-top:14px;
      display:flex; flex-wrap:wrap;
      gap:10px; align-items:center;
      justify-content:center;
    }
    .block{
      background: var(--kof-red);
      color:#fff;
      border-radius:14px;
      padding:12px 14px;
      min-width:140px;
      text-align:center;
      box-shadow: 0 14px 30px #00000040;
      font-weight:800;
    }
    .block.dark{
      background:#ffffff10;
      border:1px solid #ffffff22;
      font-weight:700;
      min-width:160px;
    }
    .op{ font-size:22px; opacity:.9; font-weight:900; }

    /* Tables */
    .tables{
      display:grid;
      grid-template-columns:1fr;
      gap:12px;
    }
    .tableWrap{
      border-radius:16px;
      border:1px solid #ffffff22;
      background:#ffffff0f;
      overflow:hidden;
    }
    .tableTitle{
      padding:10px 12px;
      font-weight:800;
      background:#ffffff12;
      border-bottom:1px solid #ffffff22;
    }
    .scroll{
      max-height:260px;
      overflow:auto;
    }
    table{
      width:100%;
      border-collapse:collapse;
      font-size:13px;
    }
    th, td{
      padding:10px 10px;
      border-bottom:1px solid #ffffff18;
      vertical-align:middle;
    }
    th{
      text-align:left;
      font-size:12px;
      opacity:.9;
      background:#ffffff08;
      position:sticky; top:0;
    }
    td input{
      width:92px;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid #ffffff25;
      background:#0e0e0ecc;
      color:#fff;
      outline:none;
      font-size:13px;
    }
    td input:focus{
      border-color:#ffffff40;
      box-shadow:0 0 0 4px #d5001c20;
    }

    /* Result */
    .resultBar{
      margin-top:16px;
      display:flex;
      justify-content:center;
    }
    .result{
      width:min(640px, 100%);
      background:#000;
      border-radius:18px;
      padding:16px;
      border:1px solid #ffffff20;
      text-align:center;
      box-shadow: 0 18px 60px #00000065;
    }
    .result .label{ opacity:.85; font-weight:700; }
    .result .value{
      margin-top:6px;
      font-size:26px;
      font-weight:900;
      letter-spacing:.3px;
    }

    /* Notes */
    .notes{
      margin-top:14px;
      font-size:13px;
      opacity:.9;
      line-height:1.45;
    }
    .notes ul{ margin:8px 0 0 18px; }
    .muted{ opacity:.75; }
  </style>
</head>

<body>
<header>
  <div class="topbar">
    <div class="brand">
      <div class="logo">KOF</div>
      <div>
        <div>Simulador PPR 2025</div>
        <div class="muted" style="font-size:12px">Público 3 | Coletivo (com ocorrências e faltas)</div>
      </div>
    </div>

    <nav>
      <a href="#" onclick="alert('Sugestão: linkar para sua Home (index.html).')">Home</a>
      <a href="#" onclick="alert('Sugestão: linkar para PPR Coletivo 2025.')">PPR Coletivo 2025</a>
      <a href="#" onclick="document.getElementById('regras').scrollIntoView({behavior:'smooth'})">Regras</a>
    </nav>

    <div class="tag">Valores arredondados • Simulação</div>
  </div>
</header>

<main class="wrap">
  <h1>Preencha abaixo e clique em Calcular</h1>
  <p class="subtitle">Este público considera: <b>Resultado Coletivo</b>, <b>Extra por Ocorrência</b> (pela faixa de ocorrências) e <b>Coeficiente por Faltas Não Justificadas</b>.</p>

  <div class="grid">
    <!-- Left: Calculator -->
    <section class="panel">
      <div class="row">
        <div class="field">
          <label for="resultadoColetivo">Resultado Coletivo</label>
          <input id="resultadoColetivo" type="number" step="0.0001" value="1" />
        </div>

        <div class="field">
          <label for="salario">Salário Dez/25 (R$)</label>
          <input id="salario" type="number" step="0.01" value="2000" />
        </div>

        <div class="field">
          <label for="meses">Meses Trabalhados</label>
          <input id="meses" type="number" step="1" min="0" max="12" value="12" />
        </div>

        <div class="field">
          <label for="faltasNJ">Faltas Não Justificadas</label>
          <input id="faltasNJ" type="number" step="1" min="0" value="0" />
        </div>
      </div>

      <div class="actions">
        <button class="btn-primary" onclick="calcular()">Calcular</button>
        <button class="btn-secondary" onclick="limpar()">Limpar</button>
        <span class="hint">Dica: preencha as ocorrências abaixo para o Extra ser calculado automaticamente.</span>
      </div>

      <div class="formula" aria-label="Fórmula">
        <div class="block" id="bColetivo">Coletivo<br><span id="vColetivo">1.0000</span></div>
        <div class="op">+</div>
        <div class="block" id="bExtra">Extra<br><span id="vExtra">0.0000</span></div>
        <div class="op">×</div>
        <div class="block">Coef. Faltas<br><span id="vCoef">1.00</span></div>
        <div class="op">×</div>
        <div class="block">Salário<br><span id="vSalario">R$ 2.000,00</span></div>
        <div class="op">×</div>
        <div class="block">Meses/12<br><span id="vProporcao">12/12</span></div>
        <div class="op">=</div>
        <div class="block dark">PPR (R$)<br><span id="vPpr">R$ 0,00</span></div>
      </div>

      <div class="resultBar">
        <div class="result">
          <div class="label">Resultado Final</div>
          <div class="value" id="resultadoFinal">R$ 0,00</div>
          <div class="muted" style="font-size:12px;margin-top:6px">
            Cálculo: <span id="explicacao">—</span>
          </div>
        </div>
      </div>

      <div id="regras" class="notes">
        <b>Considerações:</b>
        <ul>
          <li>O <b>Extra</b> é definido pela <b>quantidade total de ocorrências</b> informadas (soma de todas as linhas).</li>
          <li>O <b>Coeficiente</b> é definido pela quantidade de <b>Faltas Não Justificadas</b>.</li>
          <li>Os valores são exibidos com arredondamentos; descontos legais (IR, etc.) não são simulados aqui.</li>
          <li>Para mudanças de cargo/salário no ano, considere simulação proporcional (referência: salário de dezembro).</li>
        </ul>
      </div>
    </section>

    <!-- Right: Rules tables -->
    <aside class="panel">
      <div class="tables">
        <div class="tableWrap">
          <div class="tableTitle">Valor do Extra por Ocorrência</div>
          <div class="scroll">
            <table>
              <thead>
                <tr>
                  <th>Quantidade de Ocorrências</th>
                  <th>Valor do Extra</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>0,0 a 0,99</td><td>0,20</td></tr>
                <tr><td>1,0 a 2,99</td><td>0,15</td></tr>
                <tr><td>3,0 a 4,99</td><td>0,10</td></tr>
                <tr><td>5,0 a 6,99</td><td>0,05</td></tr>
                <tr><td>&gt;= 7,00</td><td>0</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="tableWrap">
          <div class="tableTitle">Coeficiente por Faltas Não Justificadas</div>
          <div class="scroll">
            <table>
              <thead>
                <tr>
                  <th>Faltas Não Justificadas</th>
                  <th>Valor do Coeficiente</th>
                </tr>
              </thead>
              <tbody>
                <tr><td>0</td><td>1,00</td></tr>
                <tr><td>1</td><td>0,95</td></tr>
                <tr><td>2</td><td>0,90</td></tr>
                <tr><td>3</td><td>0,85</td></tr>
                <tr><td>4</td><td>0,80</td></tr>
                <tr><td>5</td><td>0,75</td></tr>
                <tr><td>&gt;= 6</td><td>0</td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="tableWrap">
          <div class="tableTitle">Tipos de Ocorrência (preencha as quantidades)</div>
          <div class="scroll" style="max-height:340px">
            <table>
              <thead>
                <tr>
                  <th style="width:80px">Cod</th>
                  <th>Descrição</th>
                  <th style="width:120px">Qtd.</th>
                </tr>
              </thead>
              <tbody id="tbodyOcorrencias">
                <!-- Preenchido via JS -->
              </tbody>
            </table>
          </div>
        </div>

        <div class="muted" style="font-size:12px;line-height:1.35">
          Observação: todos os tipos acima estão com peso 1 (conforme parâmetro informado).
        </div>
      </div>
    </aside>
  </div>
</main>

<script>
  // Tipos de Ocorrência (Peso 1)
  const TIPOS = [
    { cod: 210,  desc: "Licença Médica INSS" },
    { cod: 340,  desc: "Suspensão" },
    { cod: 350,  desc: "Faltas não justificadas s/ DSR" },
    { cod: 351,  desc: "Faltas não justificadas s/ DSR" },
    { cod: 360,  desc: "Faltas Justificadas" },
    { cod: 380,  desc: "Licença remunerada" },
    { cod: 382,  desc: "Susp. Contrato CLT x Estat." },
    { cod: 385,  desc: "Licença remunerada s/ ded." },
    { cod: 390,  desc: "Licença não remunerada" },
    { cod: 395,  desc: "Afastamento Reclusão" },
    { cod: 9390, desc: "Lic. não remunerada / Inquérito" },
    { cod: 9410, desc: "Aposentadoria por Invalidez" },
    { cod: 9400, desc: "Suspensão Contrato Trabal." }
  ];

  // Helpers
  const fmtBRL = (n) => (isFinite(n) ? n : 0).toLocaleString("pt-BR", { style:"currency", currency:"BRL" });
  const fmt4 = (n) => (isFinite(n) ? n : 0).toFixed(4);
  const clamp = (v, min, max) => Math.min(Math.max(v, min), max);

  function buildTabelaOcorrencias(){
    const tbody = document.getElementById("tbodyOcorrencias");
    tbody.innerHTML = "";
    TIPOS.forEach(t => {
      const tr = document.createElement("tr");
      tr.innerHTML = `
        <td>${t.cod}</td>
        <td>${t.desc}</td>
        <td><input type="number" min="0" step="0.01" value="0" data-cod="${t.cod}" /></td>
      `;
      tbody.appendChild(tr);
    });

    // Recalcular extra ao editar
    tbody.querySelectorAll("input").forEach(inp => {
      inp.addEventListener("input", () => {
        // atualização leve (sem mexer no resultado final, até clicar em Calcular)
        const total = totalOcorrencias();
        document.getElementById("vExtra").textContent = fmt4(extraPorOcorrencia(total));
      });
    });
  }

  function totalOcorrencias(){
    const inputs = document.querySelectorAll("#tbodyOcorrencias input");
    let total = 0;
    inputs.forEach(i => total += (parseFloat(i.value) || 0));
    return total;
  }

  // Regras: Extra por Ocorrência (pela faixa)
  function extraPorOcorrencia(qtd){
    if (qtd < 1) return 0.20;
    if (qtd < 3) return 0.15;
    if (qtd < 5) return 0.10;
    if (qtd < 7) return 0.05;
    return 0.00;
  }

  // Regras: Coeficiente por faltas não justificadas
  function coefPorFaltas(faltas){
    const f = Math.floor(Math.max(0, faltas || 0));
    if (f === 0) return 1.00;
    if (f === 1) return 0.95;
    if (f === 2) return 0.90;
    if (f === 3) return 0.85;
    if (f === 4) return 0.80;
    if (f === 5) return 0.75;
    return 0.00; // >= 6
  }

  // Cálculo proposto para este público:
  // PPR = Salário_Dez * (Meses/12) * (Resultado_Coletivo + Extra) * Coef_Faltas
  function calcular(){
    const resultadoColetivo = parseFloat(document.getElementById("resultadoColetivo").value) || 0;
    const salario = parseFloat(document.getElementById("salario").value) || 0;
    const mesesRaw = parseFloat(document.getElementById("meses").value) || 0;
    const meses = clamp(mesesRaw, 0, 12);
    const faltasNJ = parseFloat(document.getElementById("faltasNJ").value) || 0;

    const qtdOcorr = totalOcorrencias();
    const extra = extraPorOcorrencia(qtdOcorr);
    const coef = coefPorFaltas(faltasNJ);

    const proporcao = meses / 12;
    const fator = (resultadoColetivo + extra) * coef;
    const ppr = salario * proporcao * fator;

    // UI
    document.getElementById("vColetivo").textContent = fmt4(resultadoColetivo);
    document.getElementById("vExtra").textContent = fmt4(extra);
    document.getElementById("vCoef").textContent = coef.toFixed(2);
    document.getElementById("vSalario").textContent = fmtBRL(salario);
    document.getElementById("vProporcao").textContent = `${meses.toFixed(0)}/12`;

    document.getElementById("vPpr").textContent = fmtBRL(ppr);
    document.getElementById("resultadoFinal").textContent = fmtBRL(ppr);

    document.getElementById("explicacao").textContent =
      `Salário (${fmtBRL(salario)}) × (${meses.toFixed(0)}/12) × (Coletivo ${fmt4(resultadoColetivo)} + Extra ${fmt4(extra)}) × Coef ${coef.toFixed(2)} | Ocorrências: ${qtdOcorr.toFixed(2)}`;
  }

  function limpar(){
    document.getElementById("resultadoColetivo").value = 1;
    document.getElementById("salario").value = 2000;
    document.getElementById("meses").value = 12;
    document.getElementById("faltasNJ").value = 0;

    document.querySelectorAll("#tbodyOcorrencias input").forEach(i => i.value = 0);

    document.getElementById("vColetivo").textContent = "1.0000";
    document.getElementById("vExtra").textContent = "0.0000";
    document.getElementById("vCoef").textContent = "1.00";
    document.getElementById("vSalario").textContent = "R$ 2.000,00";
    document.getElementById("vProporcao").textContent = "12/12";
    document.getElementById("vPpr").textContent = "R$ 0,00";
    document.getElementById("resultadoFinal").textContent = "R$ 0,00";
    document.getElementById("explicacao").textContent = "—";
  }

  // Init
  buildTabelaOcorrencias();
  // Pré-calcula extra como 0 ocorrências => 0,20 (para ficar coerente com a regra)
  document.getElementById("vExtra").textContent = fmt4(extraPorOcorrencia(0));
</script>
</body>
</html>
